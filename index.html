
<!DOCTYPE HTML>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script src="mass.js"></script>

        <style>
            #ccc {
                border:1px solid red;
            }
        </style>
        <script type="text/javascript; version=1.7"> 
            
function Generator(next) {
  setTimeout(next, 1000)
  var a = yield 1000
  console.log(a)

 var a = yield setTimeout(next, 1000)
  console.log(a)

  var a = yield setTimeout(next, 1000)
  console.log(a)
} 
function process(f) {
  var g
  //这是传参next, next里面再次驱动它执行生成器的next，从来形成递归调用
  g = f(function() {
    try {
      g.next();
    } catch (e) {}
  });
  g.next(); //执行它
}

process(Generator);

        </script> 

    </head>
    <body>
        <p id="aaa" data-aaa="bbb">mass messager 组件 by 司徒正美</p>

        <a href="#button" id="button">Button</a>
        <script type="text/vbscript">


        </script>
        Function.prototype.wait = function() {
        var me = this;
        alert(me)
        var g = me(function(t) {//这里就是resume
        try {
        g.send(t)
        } catch (e) {}
        });
        g.next();
        }
        Requester = function(a) {
        this.resume = a;
        };

        Requester.prototype.delay = function(time) {
        var resume = this.resume
        console.log(time+"!")
        setTimeout(function() {
        resume(time)
        }, time)
        };


        (function(resume) {

        var r = new Requester(resume);
        //这里隔1000秒才执行
        var json = yield r.delay(2000);
        console.log(json);
        //这里隔1000秒才执行
        json = yield r.delay(2000);
        console.log(json);

        }).wait()
        function onRead(obj, prop) {
        return obj[prop] + "!!";
        }
        function onWrite(obj, prop, val) {
        obj[prop] = val
        }
        var obj = {
        aa: 1,
        bb: 2,
        cc: function() {
        return 3
        }
        };
        var a = fn(obj, onRead, onWrite);
        console.log(a)
        a.aa = 4
        console.log(a.aa)// -> 1!!
        console.log(a.bb)// -> 2!!
        console.log(a.cc())// -> 3
    </body>
</html>