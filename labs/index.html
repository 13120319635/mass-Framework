<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <title>TODO supply a title</title>
        <style>

            .v_accordion  {
                background:#DCDCDC;
                width: 620px;
                height:245px;
                overflow:hidden;
            }
            .v_accordion .trigger{
                height: 30px;
                width: 600px;
                background: url(mass_accordion_trigger.jpg) no-repeat top right #a9d06a;
                padding: 0 10px 0 10px;
                line-height: 30px;
                color: #fff;
                font-size: 12px;
                color: #000;
                border-bottom: 1px solid #cde99f;
                cursor: pointer;
            }
            .v_accordion .trigger.active{
                background: url(mass_accordion_trigger_active.jpg) no-repeat top right #e0542f;
                color: #fff;
                border-bottom: 1px solid #f68263;
            }
            .v_accordion .panel {
                width: 600px;
                height: 100px;
                padding: 5px 10px 15px 10px;
                color: #444;
                overflow: hidden;
            }
            .dew {
                position:relative;
                width:500px;
                height:200px;
                overflow:hidden;
            }
            .dew .panel{
                position:absolute;
            }
            .winnower {
                width:536px;
                height:265px;
                position:relative;
                overflow:hidden;
                border:2px solid #000;
            }
            .winnower .trigger{
                position:absolute;
                display:inline-block;
                width:15px;
                height:15px;
            }
            .winnower .arrow{
                position:absolute;
                display:none;
                z-index:100;
                width:25px;
                height:40px;
                top:125px;
                background: url("winnower_s.png") no-repeat scroll -40px 0px transparent;
            }
            .winnower .prev{
                left:5px;
            }
            .winnower .next{
                background: url("winnower_s.png") no-repeat scroll -90px 0px transparent;
                right:5px;
            }
            .winnower .trigger a {
                display:inline-block;
                width:15px;
                height:15px;
                text-decoration:none;
                outline:none;
                background: url("winnower_s.png") no-repeat 3px -12px transparent;
            }
            .winnower .trigger a:hover,.winnower .trigger.active a{
                background-position:-15px -12px;
            }

        </style>
        <script type="text/javascript" src="/src/mass.js">

        </script>


        <script >
            $.require("ready,more/switchable",function( ){
                $(".v_accordion").switchable({
                    data:[
                        {trigger:"标题1",panel:"这是一个简单的垂直手风琴"},
                        {trigger:"标题2",panel:"只有最基本的功能"},
                        {trigger:"标题3",panel:"<div class=content>面板3</div>"},
                        {trigger:"标题4",panel:"<div class=content>面板4</div>"}
                    ],
                    switch_in: $.fn.slideDown,
                    switch_out: $.fn.slideUp
                });
                var dew = $(".dew").switchable({
                    data:[
                        {panel:'<div><img src="dew1.jpg" /></div>'},
                        {panel:'<div><img src="dew2.jpg" /></div>'},
                        {panel:'<div><img src="dew3.jpg" /></div>'},
                        {panel:'<div><img src="dew4.jpg" /></div>'},
                        {panel:'<div><img src="dew5.jpg" /></div>'},
                        {panel:'<div><img src="dew6.jpg" /></div>'},
                    ]
                }).switchable("getUI");
                var t = 0;
                function after(){
                    t += 1;
                    if(t == 6){
                        t = 0
                        setTimeout(function(){
                            dew.panels.one("mouseover",switchIt);
                        },300);
                    }
                }
                function switchIt(e){
                    var index = $(this).index();
                    var width =  $(this).width();
                    dew.panels.each(function(el,i){
                        $(el).fx(500,{left:i * 36+( i > index ? width - 36: 0),after:after})
                    });
                }
                dew.panels.each(function(el, i){
                    $(el).css({
                        left: i * 83,
                        display:"block"
                    });
                }).one("mouseover",switchIt);
                dew.target.mouseleave(function(){
                    dew.panels.each(function(el, i){
                        $(el).fx(500,{
                            left: i * 83
                        });
                    });
                });

                var winnower = $(".winnower").switchable({
                    data: [
                        {trigger:"<a href='javascript:void(0)'></a>",panel:'<div><img src="winnower0.jpg" /></div>'},
                        {trigger:"<a href='javascript:void(0)'></a>",panel:'<div><img src="winnower1.jpg" /></div>'},
                        {trigger:"<a href='javascript:void(0)'></a>",panel:'<div><img src="winnower2.jpg" /></div>'},
                        {trigger:"<a href='javascript:void(0)'></a>",panel:'<div><img src="winnower3.jpg" /></div>'},
                        {trigger:"<a href='javascript:void(0)'></a>",panel:'<div><img src="winnower4.jpg" /></div>'},
                    ],
                    active_callback: function(){
                        var w = -1 * winnower.panels.innerWidth() * winnower.active_index;
                        console.log(w)
                        winnower.target.fx(500,{"margin-left":w }  )
                    }
                }).switchable("getUI");
                winnower.panels.css({
                    "float":"left",
                    "display":"inline-block"
                })
                winnower.target.width(winnower.panels.innerWidth() * 5 +10);
                var winnowerUI = $(".winnower").append('<div class="next arrow" ></div>').append('<div class="prev arrow"></div>')
                winnower.triggers.each(function(el, i){
                    $(el).css({
                        display:"inline-block",
                        zIndex:100,
                        right:100 - i * 17,
                        bottom: 20
                    })
                })
                winnowerUI.mouseenter(function(){
                    winnowerUI.find(".arrow").show()
                }).mouseleave(function(){
                    winnowerUI.find(".arrow").hide()
                });
                winnowerUI.find(".arrow").click(function(){
                    var next = $(this).hasClass("next");
                    var length = winnower.triggers.length-1
                    var i = winnower.active_index ;
                    if(next){
                        var index =  i+1 > length ? 0 : i+1;
                    }else{
                        index = i-1 < 0 ? length : i-1;
                    }
                    winnower.active( index, winnower.active_callback )
                })


            });
        </script>

    </head>
    <body class="black">
        <div class="v_accordion">

        </div>
        <p>trigger与panel一体化的水平手风琴</p>
        <div class="dew">

        </div>
        <p>轮播</p>
        <div class="winnower">

        </div>

    </body>
</html>