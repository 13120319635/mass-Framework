
<!DOCTYPE HTML>
<html>
    <head>
        <title>draggable</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <style type="text/css">
            .drag {width:100px;height:100px;z-index:200;}
            #drag1 {background:red}
            #drag2 {background:#E8D098;}
            #drag3 {background:#fff;}
            #drag4 {background:#E8FFE8;margin-right:2px;margin-left:10px;}
            #drag5 {background:#ff0;}
            #drag6 {background:#66c;}
            #drag7 {background:#FBFBEA;}
            #drag8 {background:#E8E8FF;}
            #drag9 {background:#00B271;}
            #drag10 {background:#DDF3FF;}
            .handle {width:80px;height:20px;background:aqua;}
            #parent {width:300px;height:300px;background:blue;}
            .mass_ghosting {background:black;}
        </style>
        <script type="text/javascript" src="../src/mass.js">

        </script>
        <script>
            $.require("ready,event,flow",function(){
                var keystateTime = 0, i = 0;
                function checkInterval(){
                    if(!keystateTime){
                        keystateTime = new Date;
                    }else{//用于判定按键的时间间隔，如果太慢则让玩家重来
                        var now = new Date - keystateTime;
                        if(now > 500){
                            keystateTime =  0;
                        }
                    }
                }
                //创建一个事件流
                var flow = $.flow("0_115,1_100,2_102", function(){
                    if( keystateTime){
                        $.log("开始攻击!!!!",true);
                        setTimeout(function(){
                            $("body > .mass_sys_log").remove();
                        },1500)
                    }
                },true);
                $(document).keypress(function(e){
                    checkInterval();
                    $.log(String.fromCharCode(e.which).toUpperCase() ,true);//显示用户按下什么键
                    flow.fire(i+"_"+e.which);
                    i++
                    if(i == 3 || e.which === 13  ){//按enter键重试
                        i = 0;
                    }
                });
            });
        </script>
    </head>
    <body>
        <p>请迅速地按下S，D，F键!</p>
    </body>
</html>
