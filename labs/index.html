<!doctype html>
<html>
    <head>
        <title>mass Framework</title>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
        <!--  <script src="../src/enchant.js"></script>-->
        <script src="../src/mass.js"></script>
        <style type="text/css">
            #waterfall{
                width:1100px;
                height:300px;
                background:red;
                /*  background: url("../public/styles/waterfall/waterfall_bc.jpg") repeat scroll 0 0 transparent;*/
            }
            .clearfix:after {
                content: "";
                display: block;
                height: 0;
                clear: both;
                visibility: hidden;
            }
            .clearfix {zoom:1;}
            .waterfall-cell{
                width:198px;
                padding:20px;
                margin-top:10px;
                border:1px solid #ccc;
                -moz-box-shadow:2px 2px 10px #c96;
                -webkit-box-shadow:2px 2px 10px #c96;
                box-shadow:2px 2px 10px #c96;
                border-radius: 2px 2px 2px 2px;
                background-color: #F7F7F7;
            }
            .image-parent {
                text-align:center;
            }
            .waterfall-cell .dis{
                width:198px;
            }
            .footer{
                height:24px;
                line-height:24px;
                background:gray;
            }
        </style>

        <script>

        
            (function(watch, unwatch){
                createWatcher = watch && unwatch ?
                    // Andrea Giammarchi - Mit Style License
                function(Object){
                    var handlers = [];
                    return {
                        destroy:function(){
                            handlers.forEach(function(prop){
                                unwatch.call(this, prop);
                            }, this);
                            delete handlers;
                        },
                        watch:function(prop, handler){
                            if(-1 === handlers.indexOf(prop))
                                handlers.push(prop);
                            watch.call(this, prop, function(prop, prevValue, newValue){
                                return Object[prop] = handler.call(Object, prop, prevValue, newValue);
                            });
                        },
                        unwatch:function(prop){
                            var i = handlers.indexOf(prop);
                            if(-1 !== i){
                                unwatch.call(this, prop);
                                handlers.splice(i, 1);
                            };
                        }
                    }
                }:(Object.prototype.__defineSetter__?
                    function(Object){
                    var handlers = [];
                    return {
                        destroy:function(){
                            handlers.forEach(function(prop){
                                delete this[prop];
                            }, this);
                            delete handlers;
                        },
                        watch:function(prop, handler){
                            if(-1 === handlers.indexOf(prop))
                                handlers.push(prop);
                            if(!this.__lookupGetter__(prop))
                                this.__defineGetter__(prop, function(){return Object[prop]});
                            this.__defineSetter__(prop, function(newValue){
                                Object[prop] = handler.call(Object, prop, Object[prop], newValue);
                            });
                        },
                        unwatch:function(prop){
                            var i = handlers.indexOf(prop);
                            if(-1 !== i){
                                delete this[prop];
                                handlers.splice(i, 1);
                            };
                        }
                    };
                }:
                    function(Object){
                    function onpropertychange(){
                        var prop = event.propertyName,
                        newValue = empty[prop]
                        prevValue = Object[prop],
                        handler = handlers[prop];
                        if(handler)
                            attachEvent(detachEvent()[prop] = Object[prop] = handler.call(Object, prop, prevValue, newValue));
                    };
                    function attachEvent(){empty.attachEvent("onpropertychange", onpropertychange)};
                    function detachEvent(){empty.detachEvent("onpropertychange", onpropertychange);return empty};
                    var empty = document.createElement("empty"), handlers = {};
                    empty.destroy = function(){
                        detachEvent();
                        empty.parentNode.removeChild(empty);
                        empty = handlers = null;
                    };
                    empty.watch = function(prop, handler){handlers[prop] = handler};
                    empty.unwatch = function(prop){delete handlers[prop]};
                    attachEvent();
                    return (document.getElementsByTagName("head")[0] || document.documentElement).appendChild(empty);
                }
            )
                ;
            })(Object.prototype.watch, Object.prototype.unwatch);

            var // original object
            man = {},
            // create its watcher
            manWatcher = createWatcher(man);

            manWatcher.watch("name", function(propertyName, oldValue, newValue){
                return "Mr " + newValue;
            });

            // assign name property
            manWatcher.name = "Andrea";

            // retrieve original object property
            alert(man.name); // Mr Andrea
            var obj = {},
            watcher = createWatcher(obj);

            watcher.watch("test", function(prop, oldValue, newValue){
                return oldValue === undefined ? newValue : oldValue;
            });

            watcher.test = "one assignment";
            watcher.test = "never again";

            alert(obj.test); // one assignment
        </script>

    </head>
    <body>
        <div class="sample" id="sample1" >
            <p><input type="text" id="test"/> <span>focus fire</span></p>

            <p><input type="password" /> <span>focus fire</span></p>
        </div>
        <div class="waterfall clearfix" id="waterfall">

        </div>


    </body>
</html>