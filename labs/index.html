<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <title>TODO supply a title</title>
        <style>

            .starfish  {
                background:#DCDCDC;
                width: 620px;
                height:245px;
                overflow:hidden;
            }
            .starfish .trigger{
                height: 30px;
                width: 600px;
                background: url(mass_accordion_trigger.jpg) no-repeat top right #a9d06a;
                padding: 0 10px 0 10px;
                line-height: 30px;
                color: #fff;
                font-size: 12px;
                color: #000;
                border-bottom: 1px solid #cde99f;
                cursor: pointer;
            }
            .starfish .trigger.active{
                background: url(mass_accordion_trigger_active.jpg) no-repeat top right #e0542f;
                color: #fff;
                border-bottom: 1px solid #f68263;
            }
            .starfish .panel {
                width: 600px;
                height: 100px;
                padding: 5px 10px 15px 10px;
                color: #444;
                display:none;
                overflow: hidden;
            }


            .dew {
                position:relative;
                width:500px;
                height:200px;
                overflow:hidden;
            }
            .dew .panel{
                position:absolute;
            }


            .winnower {
                width:536px;
                height:265px;
                position:relative;
                overflow:hidden;
                border:2px solid #000;
            }
            /* 平铺所有面板，实现整体往左移或往右移*/
            .winnower .panel{
                float:left;
                display:inline-block;
            }
            /* 设置触发点*/
            .winnower .trigger{
                position:absolute;
                display: block;
                width:15px;
                height:15px;
                z-index:100;
                bottom: 20px;
            }
            /* 灰色的圆点 */
            .winnower .trigger a {
                display:block;
                width:15px;
                height:15px;
                text-decoration:none;
                outline:none;
                background: url("winnower_s.png") no-repeat 3px -12px transparent;
            }
            /* 橙色的圆点 */
            .winnower .trigger a:hover,.winnower .trigger.active a{
                background-position:-15px -12px;
            }
            /*上一个与下一个*/
            .winnower .arrow{
                position:absolute;
                display:none;
                z-index:100;
                width:25px;
                height:40px;
                top:125px;
                background: url("winnower_s.png") no-repeat scroll -40px 0px transparent;
            }
            .winnower .prev{
                left:5px;
            }
            .winnower .next{
                background: url("winnower_s.png") no-repeat scroll -90px 0px transparent;
                right:5px;
            }
            .imac{
                width:640px;
                height:545px;
                overflow:hidden;
                border:2px solid #5296c7;
            }
            .imac .panel{
                float:left;
                width:640px;
                height:480px;
                display:inline-block;
            }
            .imac .trigger{
                display:inline-block;
                margin-top:10px;
                margin-right:10px;
            }
            .imac .trigger img{
                display:inline-block;
                border:1px solid #9cf;
            }
            .imac .trigger.active img,  .imac .trigger img:hover{
                border: 1px solid #369;
            }
            center {
                width:640px;
            }
            .fade{
                position:relative;
                width:478px;
                height:286px;
                border:1px solid #666;
                overflow:hidden;
            }
            .fade .panel{
                position:absolute;
            }
            .fade .triggers{
                position:absolute;
                bottom:0;
                background:#000;
                height:30px;
                width:478px; 
                filter: Alpha(Opacity=30);
                opacity:0.3;
                z-index:100;
                cursor:pointer; 
            }
            .fade .trigger {
                position:absolute;
                width:20px;
                height:20px;
                top: 4px;
            }
            .fade .trigger a{
                width:20px;
                height:20px;
                text-align:center;
                line-height:20px;
                display:inline-block;
                color:#FFF;
                border:#e5eaff 1px solid;
                background:#6f4f67;
                filter: Alpha(Opacity=90);
                opacity:0.9;
                text-decoration:none;
                cursor:pointer
            }
            .fade .trigger a:hover, .fade .trigger.active a{
                background:#900;
            }



        </style>
        <script type="text/javascript" src="/src/mass.js">

        </script>


        <script >
            $.require("ready,more/switchable",function( ){
                  $(".starfish").switchable({
                    data:[
                        {trigger:"标题1",panel:"这是一个简单的垂直手风琴"},
                        {trigger:"标题2",panel:"只有最基本的功能"},
                        {trigger:"标题3",panel:"<div class=content>面板3</div>"},
                        {trigger:"标题4",panel:"<div class=content>面板4</div>"}
                    ],
                    switch_in: $.fn.slideDown,
                    switch_out: $.fn.slideUp
                });
                var dew = $(".dew").switchable({
                    data:"012345".split("").map(function(el,d){
                        return {
                            panel:'<div><img src="dew'+d+'.jpg" /></div>'
                        }
                    }),
                    count:0
                }).switchable("getUI");

                function switchIt(e){
                    var index = $(this).index();
                    var width = $(this).width();
                    dew.panels.each(function(el,i){
                        $(el).fx(500,{
                            left:i * 36+( i > index ? width - 36: 0),
                            after:function(){
                                dew.count += 1;
                                if(dew.count == 6){
                                    dew.count = 0
                                    setTimeout(function(){
                                        dew.panels.one("mouseover",switchIt);
                                    },300);
                                }
                            }
                        })
                    });
                }

                dew.panels.each(function(el, i){
                    $(el).css("left", i * 83);
                }).one("mouseover",switchIt);
                
                dew.target.mouseleave(function(){
                    dew.panels.each(function(el, i){
                        $(el).fx(500,{
                            left: i * 83
                        });
                    });
                });

                var winnower = $(".winnower").switchable({
                    data: "01234".split("").map(function(el,d){
                        return {
                            trigger:'<a href="javascript:void(0)"></a>',
                            panel:'<div><img src="winnower'+d+'.jpg" /></div>'
                        };
                    }),
                    active_callback: function(){
                        var w = -1 * winnower.panels.innerWidth() * winnower.active_index;
                        winnower.target.fx(500, {"margin-left":w }  )
                    }
                }).switchable("getUI");

                winnower.target.width(winnower.panels.innerWidth() * 6 );

                var winnowerUI = winnower.parent.append('<div class="next arrow" ></div>').append('<div class="prev arrow"></div>')
                var winnowerArrow = winnowerUI.find(".arrow");
                winnower.triggers.each(function(el, i){
                    $(el).css( "right", 100 - i * 17)
                })
                winnowerUI.mouseenter(function(){
                    winnowerArrow.show()
                }).mouseleave(function(){
                    winnowerArrow.hide()
                });
                winnowerArrow.click(function(){
                    var next = $(this).hasClass("next");
                    var length = winnower.triggers.length-1
                    var i = winnower.active_index ;
                    if(next){
                        var index =  i+1 > length ? 0 : i+1;
                    }else{
                        index = i-1 < 0 ? length : i-1;
                    }
                    winnower.active( index, winnower.active_callback )
                });
                
                var imac = $(".imac").switchable({
                    data: "0123456".split("").map(function(el,d){
                        return {
                            trigger:'<img src="imac'+d+'.jpg" width=50 height=46 />',
                            panel:'<img src="imac'+d+'.jpg" />'
                        }
                    }),
                    active_callback: function(){
                        var w = -1 * imac.panels.innerWidth() * imac.active_index;
                        imac.target.fx(500, {"margin-left":w }  )
                    }
                }).switchable("getUI");
                imac.target.width(imac.panels.innerWidth() * 7 );
                $("<center></center>").appendTo(".imac").append(imac.triggers);
             /*   imac.parent.delegate(".trigger","click",function(e){
                    var index = imac.triggers.index( $(e.target).closest(".trigger"));
                    imac.active(index, imac.active_callback, e);
                });*/
               
                var fade = $(".fade").switchable({
                    data: "0123".split("").map(function(el,d){
                        return {
                            panel:'<img src="fade'+d+'.jpg" />',
                            trigger:'<a href="javascript:void(0)">'+(d+1)+"</a>"
                        }
                    }),
                    switch_in: function(){
                        this.fx(600,{o:1})
                    },
                    switch_out: function(){
                        this.fx(600,{o:0})
                    },
                    interval:2000,
                    autoplay: true,
                    pause_over_panel:true
                }).switchable("getUI");
                $("<di class=triggers></div>").appendTo(fade.target).append(fade.triggers);

                fade.triggers.each(function(el, i){
                    if( i != 0){
                        fade.panels.eq(i).css("opacity",0)
                    }
                    $(el).css("right",90- i * 24)
                });
                //     (".imac .switchable").append('<span class="clear"></span>')
            });
        </script>

    </head>
    <body class="black8">
        <div class="starfish">

        </div>
        <p>trigger与panel一体化的水平手风琴</p>
        <div class="dew">

        </div>
        <p>轮播</p>
        <div class="winnower">

        </div>
        <div class="imac">

        </div>
        <div class="fade">

        </div>
    </body>
</html>